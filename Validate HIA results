# Validate results received from HIA and rate calculations

library(raster)
library(rgdal)

setwd('/home/vtinney/run/results/no2/all.cause/paf/bay/')

# Select results to validate. In this case: All ages, zip code rate, larkin concentrations and atkinson beta
	test <- raster('bay.paf.atkin.point.ppb.zip.all.ls.day.larkin.ppb.tif')

# Read in all input files
	setwd('/home/vtinney/run/')
	pop <- raster('pop/bay.pop.ls.day.tif')
	zip <- raster('rates/mortality.zip.all.tif')
	beta <- raster('betas/beta.atkin.point.ppb.tif')
	larkin <- raster('conc/conc.larkin.ppb.tif')


z <- sampleRandom(test, size=10, na.rm=TRUE, xy=TRUE, rowcol=TRUE)

       row  col         x        y
 [1,]  443 1343 -122.5137 38.49625
 [2,]  469 1702 -122.2146 38.47458
 [3,] 1364 1903 -122.0471 37.72875
 [4,]  386 1099 -122.7171 38.54375
 [5,]  844 1373 -122.4887 38.16208
 [6,] 1804 1869 -122.0754 37.36208
 [7,] 1009 1652 -122.2562 38.02458
 [8,] 1408 2179 -121.8171 37.69208
 [9,]  486 2197 -121.8021 38.46042
[10,]  812 1632 -122.2729 38.18875
      bay.paf.atkin.point.ppb.zip.all.ls.day.larkin.ppb
 [1,]                                      0.0000000000
 [2,]                                      0.0000000000
 [3,]                                      0.0000000000
 [4,]                                      0.0000000000
 [5,]                                      0.0000000000
 [6,]                                      0.0001614253
 [7,]                                      0.0005729500
 [8,]                                      0.0000000000
 [9,]                                      0.0000000000
[10,]                                      0.0022978685
>


r <- stack(pop, zip, beta, larkin)


r[1009, 1652]
     bay.pop.ls.day mortality.zip.all beta.atkin.point.ppb conc.larkin.ppb
[1,]              6          72.46377          0.001105454              12



t <- 6*72.46377*(10^-4)*(1-exp(-0.001105454*12))
t
